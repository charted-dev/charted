# Include local clippy/rustfmt.toml files
build --@rules_rust//:rustfmt.toml=//:rustfmt.toml
build --@rules_rust//:clippy.toml=//:clippy.toml

# Required for Windows
common --enable_platform_specific_config
startup --windows_enable_symlinks
build:windows --enable_runfiles

# rustc optimization flags (for release binaries)
#
# lto: https://doc.rust-lang.org/rustc/codegen-options/index.html#lto
# opt-level: https://doc.rust-lang.org/rustc/codegen-options/index.html#opt-level
# strip: https://doc.rust-lang.org/rustc/codegen-options/index.html#strip
build:opt --@rules_rust//:extra_rustc_flag="-C lto=true"
build:opt --@rules_rust//:extra_rustc_flag="-C opt-level=s"
build:opt --@rules_rust//:extra_rustc_flag="-C strip=symbols"

# workaround for test cache
# https://github.com/bazelbuild/bazel/issues/6038
common --experimental_allow_tags_propagation

# Always show test output.
test --test_output=all

# Allows importing from user-defined .bazelrc files; this is ignored
# by Git by default.
try-import %workspace%/.user.bazelrc
